<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3D 水族箱世界</title>

<style>
body{
  margin:0;
  background:#000;
  overflow:hidden;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

/* 3D 視角 */
.scene{
  perspective: 1200px;
  width:100vw;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

/* 立方體 */
.cube{
  position:relative;
  transform-style: preserve-3d;
  transition: transform 1.2s ease;
}

/* 共用面 */
.face{
  position:absolute;
  background: rgba(0,150,255,0.08);
  border:1px solid rgba(0,200,255,0.3);
  box-shadow:0 0 25px rgba(0,150,255,0.3);
  backdrop-filter: blur(4px);
}

/* Canvas 填滿 */
.face canvas{
  width:100%;
  height:100%;
  display:block;
}
</style>
</head>
<body>

<div class="scene">
  <div class="cube" id="cube">
    <div class="face top">
      <canvas id="mapCanvas"></canvas>
    </div>
    <div class="face front">
      <canvas id="shallowCanvas"></canvas>
    </div>
    <div class="face right">
      <canvas id="deepCanvas"></canvas>
    </div>
  </div>
</div>

<script>
const cube = document.getElementById("cube");
const topFace = document.querySelector(".top");
const frontFace = document.querySelector(".front");
const rightFace = document.querySelector(".right");

function resizeCube(){

  const size = Math.min(window.innerWidth, window.innerHeight) * 0.7;

  const topHeight = size * 0.25;
  const shallowHeight = size * 0.25;
  const deepHeight = size * 0.45;

  const totalHeight = topHeight + shallowHeight + deepHeight;

  cube.style.width = size + "px";
  cube.style.height = totalHeight + "px";

  // Top face
  topFace.style.width = size + "px";
  topFace.style.height = topHeight + "px";
  topFace.style.transform =
    `rotateX(90deg) translateZ(${totalHeight/2}px)`;

  // Front face
  frontFace.style.width = size + "px";
  frontFace.style.height = totalHeight + "px";
  frontFace.style.transform =
    `translateZ(${size/2}px)`;

  // Right face
  rightFace.style.width = size + "px";
  rightFace.style.height = totalHeight + "px";
  rightFace.style.transform =
    `rotateY(90deg) translateZ(${size/2}px)`;

  // 初始角度
  cube.style.transform =
    "rotateX(20deg) rotateY(45deg)";
}

window.addEventListener("resize", resizeCube);
resizeCube();


// ===== 測試繪圖 =====

function drawTest(){

  const mapCtx = mapCanvas.getContext("2d");
  const shallowCtx = shallowCanvas.getContext("2d");
  const deepCtx = deepCanvas.getContext("2d");

  mapCanvas.width = mapCanvas.clientWidth;
  mapCanvas.height = mapCanvas.clientHeight;

  shallowCanvas.width = shallowCanvas.clientWidth;
  shallowCanvas.height = shallowCanvas.clientHeight;

  deepCanvas.width = deepCanvas.clientWidth;
  deepCanvas.height = deepCanvas.clientHeight;

  // 上層
  mapCtx.fillStyle = "#2e7d32";
  mapCtx.fillRect(0,0,mapCanvas.width,mapCanvas.height);

  // 淺水
  const g1 = shallowCtx.createLinearGradient(0,0,0,shallowCanvas.height);
  g1.addColorStop(0,"#4fc3f7");
  g1.addColorStop(1,"#0288d1");
  shallowCtx.fillStyle = g1;
  shallowCtx.fillRect(0,0,shallowCanvas.width,shallowCanvas.height);

  // 深水
  const g2 = deepCtx.createLinearGradient(0,0,0,deepCanvas.height);
  g2.addColorStop(0,"#01579b");
  g2.addColorStop(1,"#001f3f");
  deepCtx.fillStyle = g2;
  deepCtx.fillRect(0,0,deepCanvas.width,deepCanvas.height);
}

drawTest();


// ===== 戰鬥測試旋轉 =====
function battleView(){
  cube.style.transform =
    "rotateX(10deg) rotateY(20deg) scale(1.1)";
}

function normalView(){
  cube.style.transform =
    "rotateX(20deg) rotateY(45deg) scale(1)";
}

// 測試：3秒後切戰鬥視角
setTimeout(battleView,3000);
setTimeout(normalView,6000);

</script>
</body>
</html>