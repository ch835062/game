<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>整塊立方體地圖</title>
<style>
body{ margin:0; background:#111; overflow:hidden;}
canvas{ display:block;}
</style>
</head>
<body>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

function iso(x,y,tileW,tileH){
  return {
    x:(x-y)*tileW/2,
    y:(x+y)*tileH/2
  };
}

let time = 0;

function drawBigMap(){

  const tileW = Math.min(canvas.width,canvas.height)/5;
  const tileH = tileW/2;

  const mapSize = 6;       // 地圖寬度
  const height = tileW;    // 地圖厚度

  const cx = canvas.width/2;
  const cy = canvas.height/3;

  const p = iso(mapSize/2,mapSize/2,tileW,tileH);
  const sx = cx;
  const sy = cy;

  // ===== 上表面 =====
  ctx.fillStyle="#4caf50";
  ctx.beginPath();
  ctx.moveTo(sx, sy-height);
  ctx.lineTo(sx+mapSize*tileW/2, sy-mapSize*tileH/2-height);
  ctx.lineTo(sx, sy-mapSize*tileH-height);
  ctx.lineTo(sx-mapSize*tileW/2, sy-mapSize*tileH/2-height);
  ctx.closePath();
  ctx.fill();

  // ===== 左側 =====
  ctx.fillStyle="#388e3c";
  ctx.beginPath();
  ctx.moveTo(sx-mapSize*tileW/2, sy-mapSize*tileH/2-height);
  ctx.lineTo(sx-mapSize*tileW/2, sy-mapSize*tileH/2);
  ctx.lineTo(sx, sy);
  ctx.lineTo(sx, sy-height);
  ctx.closePath();
  ctx.fill();

  // ===== 右側 =====
  ctx.fillStyle="#2e7d32";
  ctx.beginPath();
  ctx.moveTo(sx+mapSize*tileW/2, sy-mapSize*tileH/2-height);
  ctx.lineTo(sx+mapSize*tileW/2, sy-mapSize*tileH/2);
  ctx.lineTo(sx, sy);
  ctx.lineTo(sx, sy-height);
  ctx.closePath();
  ctx.fill();

  // ===== 水池（凹洞）=====
  const waterSize = 3;
  const waterDepth = tileW*0.8;
  const wave = Math.sin(time)*4;

  const wx = sx;
  const wy = sy - height + tileH*2;

  // 水面
  ctx.fillStyle="#4fc3f7";
  ctx.beginPath();
  ctx.moveTo(wx, wy-waterDepth+wave);
  ctx.lineTo(wx+waterSize*tileW/2, wy-waterSize*tileH/2-waterDepth+wave);
  ctx.lineTo(wx, wy-waterSize*tileH-waterDepth+wave);
  ctx.lineTo(wx-waterSize*tileW/2, wy-waterSize*tileH/2-waterDepth+wave);
  ctx.closePath();
  ctx.fill();

  // 水側面
  ctx.fillStyle="rgba(21,101,192,0.85)";
  ctx.beginPath();
  ctx.moveTo(wx-waterSize*tileW/2, wy-waterSize*tileH/2-waterDepth);
  ctx.lineTo(wx-waterSize*tileW/2, wy-waterSize*tileH/2);
  ctx.lineTo(wx, wy);
  ctx.lineTo(wx, wy-waterDepth);
  ctx.closePath();
  ctx.fill();

  ctx.fillStyle="rgba(13,71,161,0.9)";
  ctx.beginPath();
  ctx.moveTo(wx+waterSize*tileW/2, wy-waterSize*tileH/2-waterDepth);
  ctx.lineTo(wx+waterSize*tileW/2, wy-waterSize*tileH/2);
  ctx.lineTo(wx, wy);
  ctx.lineTo(wx, wy-waterDepth);
  ctx.closePath();
  ctx.fill();

}

function render(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawBigMap();
  time+=0.05;
  requestAnimationFrame(render);
}

render();
</script>
</body>
</html>